<!DOCTYPE <!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>无标题文档</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <style>
        #uploadPreview {
            width: 168px;
            height: 168px;
            background-position: center center;
            background-size: cover;
            border: 4px solid #fff;
            box-shadow: 0 0 1px 1px rgba(37, 14, 14, 0.3);
            display: inline-block;
        }
    </style>
</head>
<!-- <link href="./bootstrap/js/plugins/layui2.0/css/layui.css" rel="stylesheet"> -->
<link href="./bootstrap/css/bootstrap.min.css?v=3.3.5" rel="stylesheet" />
<!-- <link href="./bootstrap/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" /> -->
<!-- <link href="./bootstrap/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" /> -->
<!-- <link href="./bootstrap/css/animate.min.css" rel="stylesheet" /> -->
<!-- <link href="./bootstrap/css/style.min.css?v=4.0.0" rel="stylesheet" /> -->
<script src="./bootstrap/js/jquery.min.js?v=2.1.4"></script>
<!-- <script src="./bootstrap/js/plugins/layer/layer.js"></script> -->
<!-- <script src="./bootstrap/js/plugins/layui2.0/layui.js"></script> -->
<script src="./bootstrap/js/bootstrap.min.js?v=3.3.5"></script>
<!-- <script src="./bootstrap/js/plugins/validate/jquery.validate.min.js"></script> -->
<!-- <link rel="stylesheet" href="//res.layui.com/layui/dist/css/layui.css" media="all"> -->
<!-- <link href="personal.css" rel="stylesheet"> -->
<!-- 文件上传css start -->
<link href="./bootstrap/plugins/fileinput/css/fileinput.min.css" rel="stylesheet" />
<!-- 文件上传css end -->
<script src="./bootstrap/plugins/fileinput/js/fileinput.min.js" type="text/javascript"></script>
<script src="./bootstrap/plugins/fileinput/js/zh.js" type="text/javascript"></script>

<!-- 文件上传js end -->
<!-- <script src="personal.js"></script> -->

<body>
    <!-- <div style="position: absolute;margin: auto;background-image: url('./1.gif');width: 100%;height: 100%;background-repeat: no-repeat;
    background-position: 50% 50%;background-size: 120%">

    </div> -->
    <!-- <form class="form-horizontal m-t" id="commentForm" action="">
        <div class="form-group">
            <label class="col-sm-2 control-label">附件信息
                <font color='red'>*</font>
            </label>
            <div class="col-sm-10 control-label" style="text-align: left;">
                <span id='add_attachment_span' onclick="addWindow()">添加附件信息</span>
            </div>
        </div>
    </form> -->


    <!-- <label for="uploadImage">
        <img id="uploadPreview" src="">
    </label>
    <input id="uploadImage" type="file" name="file" class="fimg1" onchange="" accept="image/*" />
    <input id="aa" type="submit" value="上传" /> -->

    <form class="form-horizontal m-t" id="commentForm" action="">
        <div class="form-group">
            <label class="col-sm-2 control-label">添加的附件</label>
            <div class="col-sm-10  control-label">
                <input id="myfile" name="myfile" class="file-loading" type="file" multiple>
            </div>
        </div>

        <!-- <div class="form-group">
            <div class="col-sm-5 col-sm-offset-4" align="center">
                <button class="btn btn-primary" type="button" id="btn" onclick="edit()">提交</button>
                <button class="btn btn-primary" type="button" onclick="closeWindow()">关闭</button>
            </div>
        </div> -->
    </form>

    <!-- <input type="date" name="" id="" min="2018-05-05"> -->
</body>


<script type="text/javascript">
    $('#myfile').fileinput({ //初始化上传文件框

        showUpload: false,
        showRemove: false,
        uploadAsync: true,
        showCaption: false, //是否显示标题
        language: "zh", //配置语言
        uploadUrl: "uploadfile.do", //上传图片时的请求路径
        uploadExtraData: {
            "businessId": $("#id").val()
        },
        //deleteUrl: "deloading.do",//删除图片时的请求路径
        maxFileSize: 0,
        maxFileCount: 10,
        /*允许最大上传数，可以多个，当前设置单个*/
        enctype: 'multipart/form-data',
        allowedFileExtensions: ["jpg", "png", "gif"],
        /*上传文件格式*/
        msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
        dropZoneTitle: "请通过拖拽图片文件放到这里",
        dropZoneClickTitle: "或者点击此区域添加图片",
        showBrowse: false,
        browseOnZoneClick: true,
        initialPreviewAsData: true,
        // initialPreview: path,
        // initialPreviewConfig: cont,
        slugCallback: function (filename) {
            return filename.replace('(', '_').replace(']', '_');
        },


        // showUpload: false,
        // showRemove: false,
        // uploadAsync: true,
        // showCaption: false, //是否显示标题
        // language: "zh", //配置语言
        // uploadUrl: "http://192.168.1.105:8080/oyetravel/uploadfile.do",
        // uploadExtraData: {
        //     "businessId": $("#id").val()
        // },
        // maxFileSize: 0,
        // maxFileCount: 1,
        // /*允许最大上传数，可以多个，当前设置单个*/
        // enctype: 'multipart/form-data',
        // allowedFileExtensions: ["jpg", "png", "gif"],
        // /*上传文件格式*/
        // msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
        // dropZoneTitle: "请通过拖拽图片文件放到这里",
        // dropZoneClickTitle: "或者点击此区域添加图片",
        // showBrowse: false,
        // browseOnZoneClick: true,
        // slugCallback: function (filename) {
        //     return filename.replace('(', '_').replace(']', '_');
        // }
    });
    $('#myfile').on("fileuploaded", function (event, data, previewId, index) {
        /* var result = data.response;
        if(result.status == 'success'){
        	layer.alert('上传成功');
        } else {
        	layer.alert('上传失败');
        } */
    })

    // var shuangchuanlujing = "http://192.168.1.107:8080/oyetravel/addSupplierTest.htm"; //看拼音
    var shuangchuanlujing = "http://192.168.1.105:8080/oyetravel/uploadfile.do"
    // if ($("#uploadPreview")[0].src == "") {
    //     console.log("okle ")
    // }


    function showimg(u) {
        var a1 = u;
        $.ajax({
            url: shuangchuanlujing,
            data: {
                attachments_path: a1
            },
            type: "POST",
            dataType: "text",
            success: function (a, b, data) {
                // console.log(a, b, data)

                alert("添加成功");
                // window.location.href = "asd.php";

            }
        })
    }

    $("#uploadPreview").change(function () {
        console.log("aa")
        showimg($("#uploadPreview").src);
    })

    $("#uploadImage").on("change", function () {

        //获得对文件列表的引用。


        var files = !!this.files ? this.files : [];
        //如果没有选择文件，或者没有FileReader支持，返回。
        if (!files.length || !window.FileReader) return;

        // 只在选定的文件是图像时才进行。
        if (/^image/.test(files[0].type)) {

            // 创建FileReader的新实例。
            var reader = new FileReader();

            // 读取本地文件作为DataURL。
            reader.readAsDataURL(files[0]);

            // 加载时，将图像数据设置img的src路径。
            reader.onloadend = function () {

                $("#uploadPreview").attr("src", this.result);

                console.log(this.result)

            }

        }

    });


    var startDate = new Date();
    var endDate = new Date();
    endDate.setDate(startDate.getDate() + 30);
    var dataArr = [];
    var weeks = ['日', '一', '二', '三', '四', '五', '六'];
    while ((endDate.getTime() - startDate.getTime()) >= 0) {
        var month = (startDate.getMonth() + 1).toString().length == 1 ? "0" + (startDate.getMonth() + 1).toString() : (
            startDate.getMonth() + 1);
        var day = startDate.getDate().toString().length == 1 ? "0" + startDate.getDate() : startDate.getDate();
        var week = weeks[startDate.getDay()];
        dataArr.push(month + "月" + day + '日（周' + week + '）');
        startDate.setDate(startDate.getDate() + 1);

    }
    dataArr[0] = '今天' + dataArr[0].slice(6, 10);
    dataArr[1] = '明天' + dataArr[1].slice(6, 10);
    dataArr[2] = '后天' + dataArr[2].slice(6, 10);
    // console.log(dataArr);
</script>

</html>